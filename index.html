<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLSSVM - Parallel Least Squares Support Vector Machine: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_90x55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PLSSVM - Parallel Least Squares Support Vector Machine
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
   <div id="projectbrief">A Least Squares Support Vector Machine implementation using different backends.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PLSSVM - Parallel Least Squares Support Vector Machine Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <img src="logo_245x150.png" alt="" class="inline" title="![PLSSVM](../resources/logo_245x150.png)"/></p>
<h1><a class="anchor" id="autotoc_md0"></a>
PLSSVM - Parallel Least Squares Support Vector Machine</h1>
<p><a href="https://www.codacy.com/gh/SC-SGS/PLSSVM/dashboard?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=SC-SGS/PLSSVM&amp;utm_campaign=Badge_Grade"><img src="https://app.codacy.com/project/badge/Grade/e780a63075ce40c29c49d3df4f57c2af" alt="Codacy Badge" class="inline"/></a> &ensp; <a href="https://sc-sgs.github.io/PLSSVM/"><img src="https://github.com/SC-SGS/PLSSVM/actions/workflows/documentation.yml/badge.svg" alt="Generate documentation" style="pointer-events: none;" class="inline"/></a></p>
<p>A <a href="https://en.wikipedia.org/wiki/Support-vector_machine">Support Vector Machine (SVM)</a> is a supervised machine learning model. In its basic form SVMs are used for binary classification tasks. Their fundamental idea is to learn a hyperplane which separates the two classes best, i.e., where the widest possible margin around its decision boundary is free of data. This is also the reason, why SVMs are also called "large margin classifiers". To predict to which class a new, unseen data point belongs, the SVM simply has to calculate on which side of the previously calculated hyperplane the data point lies. This is very efficient since it only involves a single scalar product of the size corresponding to the numer of features of the data set.</p>
<p><img src=".figures/support_vector_machine.png" alt="strong scaling CPU" width="50%" class="inline"/> </p>
<p>However, normal SVMs suffer in their potential parallelizability. Determining the hyperplane boils down to solving a convex quadratic problem. For this, most SVM implementations use Sequential Minimal Optimization (SMO), an inherently sequential algorithm. The basic idea of this algorithm is that it takes a pair of data points and calculates the hyperplane between them. Afterward, two new data points are selected and the existing hyperplane is adjusted accordingly. This procedure is repeat until a new adjustment would be smaller than some epsilon greater than zero.</p>
<p>Some SVM implementations try to harness some parallelization potential by not drawing point pairs but group of points. In this case, the hyperplane calculation inside this group is parallelized. However, even then modern highly parallel hardware can not be utilized efficiently.</p>
<p>Therefore, we implemented a version of the original proposed SVM called <a href="https://en.wikipedia.org/wiki/Least-squares_support-vector_machine">Least Squares Support Vector Machine (LS-SVM)</a>. The LS-SVMs reformulated the original problem such that it boils down to solving a system of linear equations. For this kind of problem many highly parallel algorithms and implementations are known. We decided to use the <a href="https://en.wikipedia.org/wiki/Conjugate_gradient_method">Conjugate Gradient (CG)</a> to solve the system of linear equations.</p>
<p>Since one of our main goals was performance, we parallelized the implicit matrix-vector multiplication inside the CG algorithm. To do so, we use multiple different frameworks to be able to target a broad variety of different hardware platforms. The currently available frameworks (also called backends in our PLSSVM implementation) are:</p>
<ul>
<li><a href="https://www.openmp.org/">OpenMP</a></li>
<li><a href="https://developer.nvidia.com/cuda-zone">CUDA</a></li>
<li><a href="https://github.com/ROCm-Developer-Tools/HIP">HIP</a> (only tested on AMD GPUs)</li>
<li><a href="https://www.khronos.org/opencl/">OpenCL</a></li>
<li><a href="https://www.khronos.org/sycl/">SYCL</a> (tested implementations are <a href="https://github.com/intel/llvm">DPC++</a> and <a href="https://github.com/illuhad/hipSYCL">hipSYCL</a>; specifically the versions <a href="https://github.com/intel/llvm/tree/sycl-nightly/20230110">sycl-nightly/20230110</a> and hipSYCL commit <a href="https://github.com/illuhad/hipSYCL/commit/eb67fc46d6732b5c4f137ce5564f6adfba57eaa1">eb67fc4</a>)</li>
</ul>
<h2><a class="anchor" id="autotoc_md1"></a>
Getting Started</h2>
<h3><a class="anchor" id="autotoc_md2"></a>
Dependencies</h3>
<p>General dependencies:</p>
<ul>
<li>a C++17 capable compiler (e.g. <a href="https://gcc.gnu.org/"><code>gcc</code></a> or <a href="https://clang.llvm.org/"><code>clang</code></a>)</li>
<li><a href="https://cmake.org/">CMake</a> 3.21 or newer</li>
<li><a href="https://github.com/jarro2783/cxxopts">cxxopts ≥ v3.0.0</a>, <a href="https://github.com/fastfloat/fast_float">fast_float</a>, <a href="https://github.com/fmtlib/fmt">{fmt} ≥ v8.1.1</a>, and <a href="https://github.com/bluescarni/igor">igor</a> (all four are automatically build during the CMake configuration if they couldn't be found using the respective <code>find_package</code> call)</li>
<li><a href="https://github.com/google/googletest">GoogleTest ≥ v1.11.0</a> if testing is enabled (automatically build during the CMake configuration if <code>find_package(GTest)</code> wasn't successful)</li>
<li><a href="https://www.doxygen.nl/index.html">doxygen</a> if documentation generation is enabled</li>
<li><a href="https://github.com/pybind/pybind11">Pybind11 ≥ v2.10.3</a> if Python bindings are enabled</li>
<li><a href="https://www.openmp.org/">OpenMP</a> 4.0 or newer (optional) to speed-up library utilities (like file parsing)</li>
<li>multiple Python modules used in the utility scripts, to install all modules use <code>pip install --user -r install/python_requirements.txt</code></li>
</ul>
<p>Additional dependencies for the OpenMP backend:</p>
<ul>
<li>compiler with OpenMP support</li>
</ul>
<p>Additional dependencies for the CUDA backend:</p>
<ul>
<li>CUDA SDK</li>
<li>either NVIDIA <a href="https://docs.nvidia.com/cuda/cuda-compiler-driver-nvcc/index.html"><code>nvcc</code></a> or <a href="https://llvm.org/docs/CompileCudaWithLLVM.html"><code>clang</code> with CUDA support enabled</a></li>
</ul>
<p>Additional dependencies for the HIP backend:</p>
<ul>
<li>working ROCm and HIP installation</li>
<li><a href="https://rocmdocs.amd.com/en/latest/Programming_Guides/HIP-FAQ.html">clang with HIP support</a></li>
</ul>
<p>Additional dependencies for the OpenCL backend:</p>
<ul>
<li>OpenCL runtime and header files</li>
</ul>
<p>Additional dependencies for the SYCL backend:</p>
<ul>
<li>the code must be compiled with a SYCL capable compiler; currently tested with <a href="https://github.com/intel/llvm">DPC++</a> and <a href="https://github.com/illuhad/hipSYCL">hipSYCL</a></li>
</ul>
<p>Additional dependencies if <code>PLSSVM_ENABLE_TESTING</code> and <code>PLSSVM_GENERATE_TEST_FILE</code> are both set to <code>ON</code>:</p>
<ul>
<li><a href="https://www.python.org/">Python3</a> with the <a href="https://docs.python.org/3/library/argparse.html"><code>argparse</code></a>, <a href="https://docs.python.org/3/library/timeit.html"><code>timeit</code></a>, <a href="https://scikit-learn.org/stable/"><code>sklearn</code></a>, and <a href="https://pypi.org/project/humanize/"><code>humanize</code></a> modules</li>
</ul>
<h3><a class="anchor" id="autotoc_md3"></a>
Building</h3>
<p>Building the library can be done using the normal CMake approach:</p>
<div class="fragment"><div class="line">git clone https://github.com/SC-SGS/PLSSVM.git</div>
<div class="line">cd PLSSVM </div>
<div class="line">mkdir build &amp;&amp; cd build </div>
<div class="line">cmake -DPLSSVM_TARGET_PLATFORMS=&quot;...&quot; [optional_options] .. </div>
<div class="line">cmake --build . -j</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md4"></a>
Target Platform Selection</h4>
<p>The CMake option <code>PLSSVM_TARGET_PLATFORMS</code> is used to determine for which targets the backends should be compiled. Valid targets are:</p>
<ul>
<li><code>cpu</code>: compile for the CPU; an <b>optional</b> architectural specifications is allowed but only used when compiling with DPC++, e.g., <code>cpu:avx2</code></li>
<li><code>nvidia</code>: compile for NVIDIA GPUs; <b>at least one</b> architectural specification is necessary, e.g., <code>nvidia:sm_86,sm_70</code></li>
<li><code>amd</code>: compile for AMD GPUs; <b>at least one</b> architectural specification is necessary, e.g., <code>amd:gfx906</code></li>
<li><code>intel</code>: compile for Intel GPUs; <b>at least one</b> architectural specification is necessary, e.g., <code>intel:skl</code></li>
</ul>
<p>At least one of the above targets must be present. If the option <code>PLSSVM_TARGET_PLATFORMS</code> is not present, the targets are automatically determined using the Python3 <code>utility_scripts/plssvm_target_platforms.py</code> script (required Python3 dependencies: <a href="https://docs.python.org/3/library/argparse.html"><code>argparse</code></a>, <a href="https://pypi.org/project/py-cpuinfo/"><code>py-cpuinfo</code></a>, <a href="https://pypi.org/project/GPUtil/"><code>GPUtil</code></a>, <a href="https://pypi.org/project/pyamdgpuinfo/"><code>pyamdgpuinfo</code></a>, and <a href="https://pypi.org/project/pylspci/"><code>pylspci</code></a>).</p>
<p>Note that when using DPC++ only a single architectural specification for <code>cpu</code>, <code>nvidia</code> or <code>amd</code> is allowed.</p>
<div class="fragment"><div class="line">python3 utility_scripts/plssvm_target_platforms.py --help</div>
<div class="line">usage: plssvm_target_platforms.py [-h] [--quiet]</div>
<div class="line"> </div>
<div class="line">optional arguments:</div>
<div class="line">  -h, --help  show this help message and exit</div>
<div class="line">  --quiet     only output the final PLSSVM_TARGET_PLATFORMS string</div>
</div><!-- fragment --><p>Example invocation:</p>
<div class="fragment"><div class="line">python3 utility_scripts/plssvm_target_platforms.py</div>
<div class="line">Intel(R) Core(TM) i9-10980XE CPU @ 3.00GHz: {&#39;avx512&#39;: True, &#39;avx2&#39;: True, &#39;avx&#39;: True, &#39;sse4_2&#39;: True}</div>
<div class="line"> </div>
<div class="line">Found 1 NVIDIA GPU(s):</div>
<div class="line">  1x NVIDIA GeForce RTX 3080: sm_86</div>
<div class="line"> </div>
<div class="line">Possible -DPLSSVM_TARGET_PLATFORMS entries:</div>
<div class="line">cpu:avx512;nvidia:sm_86</div>
</div><!-- fragment --><p>or with the <code>--quiet</code> flag given:</p>
<div class="fragment"><div class="line">python3 utility_scripts/plssvm_target_platforms.py --quiet</div>
<div class="line">cpu:avx512;intel:dg1</div>
</div><!-- fragment --><p>If the architectural information for the requested GPU could not be retrieved, one option would be to have a look at:</p>
<ul>
<li>for NVIDIA GPUs: <a href="https://developer.nvidia.com/cuda-gpus">Your GPU Compute Capability</a></li>
<li>for AMD GPUs: <a href="https://llvm.org/docs/AMDGPUUsage.html">clang AMDGPU backend usage</a></li>
<li>for Intel GPUs and CPUs: <a href="https://www.intel.com/content/www/us/en/develop/documentation/oneapi-dpcpp-cpp-compiler-dev-guide-and-reference/top/compilation/ahead-of-time-compilation.html">Ahead of Time Compilation</a> and <a href="https://dgpu-docs.intel.com/devices/hardware-table.html">Intel graphics processor table</a></li>
</ul>
<h4><a class="anchor" id="autotoc_md5"></a>
Optional CMake Options</h4>
<p>The <code>[optional_options]</code> can be one or multiple of:</p>
<ul>
<li><code>PLSSVM_ENABLE_OPENMP_BACKEND=ON|OFF|AUTO</code> (default: <code>AUTO</code>):<ul>
<li><code>ON</code>: check for the OpenMP backend and fail if not available</li>
<li><code>AUTO</code>: check for the OpenMP backend but <b>do not</b> fail if not available</li>
<li><code>OFF</code>: do not check for the OpenMP backend</li>
</ul>
</li>
<li><code>PLSSVM_ENABLE_CUDA_BACKEND=ON|OFF|AUTO</code> (default: <code>AUTO</code>):<ul>
<li><code>ON</code>: check for the CUDA backend and fail if not available</li>
<li><code>AUTO</code>: check for the CUDA backend but <b>do not</b> fail if not available</li>
<li><code>OFF</code>: do not check for the CUDA backend</li>
</ul>
</li>
<li><code>PLSSVM_ENABLE_HIP_BACKEND=ON|OFF|AUTO</code> (default: <code>AUTO</code>):<ul>
<li><code>ON</code>: check for the HIP backend and fail if not available</li>
<li><code>AUTO</code>: check for the HIP backend but <b>do not</b> fail if not available</li>
<li><code>OFF</code>: do not check for the HIP backend</li>
</ul>
</li>
<li><code>PLSSVM_ENABLE_OPENCL_BACKEND=ON|OFF|AUTO</code> (default: <code>AUTO</code>):<ul>
<li><code>ON</code>: check for the OpenCL backend and fail if not available</li>
<li><code>AUTO</code>: check for the OpenCL backend but <b>do not</b> fail if not available</li>
<li><code>OFF</code>: do not check for the OpenCL backend</li>
</ul>
</li>
<li><code>PLSSVM_ENABLE_SYCL_BACKEND=ON|OFF|AUTO</code> (default: <code>AUTO</code>):<ul>
<li><code>ON</code>: check for the SYCL backend and fail if not available</li>
<li><code>AUTO</code>: check for the SYCL backend but <b>do not</b> fail if not available</li>
<li><code>OFF</code>: do not check for the SYCL backend</li>
</ul>
</li>
</ul>
<p><b>Attention:</b> at least one backend must be enabled and available!</p>
<ul>
<li><code>PLSSVM_ENABLE_ASSERTS=ON|OFF</code> (default: <code>OFF</code>): enables custom assertions regardless whether the <code>DEBUG</code> macro is defined or not</li>
<li><code>PLSSVM_THREAD_BLOCK_SIZE</code> (default: <code>16</code>): set a specific thread block size used in the GPU kernels (for fine-tuning optimizations)</li>
<li><code>PLSSVM_INTERNAL_BLOCK_SIZE</code> (default: <code>6</code>: set a specific internal block size used in the GPU kernels (for fine-tuning optimizations)</li>
<li><code>PLSSVM_OPENMP_BLOCK_SIZE</code> (default: <code>64</code>): set a specific block size used in the OpenMP kernels</li>
<li><code>PLSSVM_ENABLE_LTO=ON|OFF</code> (default: <code>ON</code>): enable interprocedural optimization (IPO/LTO) if supported by the compiler</li>
<li><code>PLSSVM_ENABLE_DOCUMENTATION=ON|OFF</code> (default: <code>OFF</code>): enable the <code>doc</code> target using doxygen</li>
<li><code>PLSSVM_ENABLE_PERFORMANCE_TRACKING</code>: enable gathering performance characteristics for the three executables using YAML files; example Python3 scripts to perform performance measurements and to process the resulting YAML files can be found in the <code>utility_scripts/</code> directory (requires the Python3 modules <a href="https://pypi.org/project/wrapt-timeout-decorator/">wrapt-timeout-decorator</a>, <a href="https://pyyaml.org/"><code>pyyaml</code></a>, and <a href="https://pint.readthedocs.io/en/stable/"><code>pint</code></a>)</li>
<li><code>PLSSVM_ENABLE_TESTING=ON|OFF</code> (default: <code>ON</code>): enable testing using GoogleTest and ctest</li>
<li><code>PLSSVM_ENABLE_LANGUAGE_BINDINGS=ON|OFF</code> (default: <code>OFF</code>): enable language bindings</li>
</ul>
<p>If <code>PLSSVM_ENABLE_TESTING</code> is set to <code>ON</code>, the following options can also be set:</p>
<ul>
<li><code>PLSSVM_GENERATE_TEST_FILE=ON|OFF</code> (default: <code>ON</code>): automatically generate test files<ul>
<li><code>PLSSVM_TEST_FILE_NUM_DATA_POINTS</code> (default: <code>5000</code>): the number of data points in the test file</li>
<li><code>PLSSVM_TEST_FILE_NUM_FEATURES</code> (default: <code>2000</code>): the number of features per data point in the test file</li>
</ul>
</li>
</ul>
<p>If <code>PLSSVM_ENABLE_LANGUAGE_BINDINGS</code> is set to <code>ON</code>, the following option can also be set:</p>
<ul>
<li><code>PLSSVM_ENABLE_PYTHON_BINDINGS=ON|OFF</code> (default: <code>PLSSVM_ENABLE_LANGUAGE_BINDINGS</code>): enable Python bindings using Pybind11</li>
</ul>
<p>If <code>PLSSVM_ENABLE_PYTHON_BINDINGS</code> is set to <code>ON</code>, the following options can also be set:</p>
<ul>
<li><code>PLSSVM_PYTHON_BINDINGS_PREFERRED_REAL_TYPE</code> (default: <code>double</code>): the default <code>real_type</code> used if the generic <code>plssvm.Model</code> and <code>plssvm.DataSet</code> Python classes are used</li>
<li><code>PLSSVM_PYTHON_BINDINGS_PREFERRED_LABEL_TYPE</code> (default: <code>std::string</code>): the default <code>label_type</code> used if the generic <code>plssvm.Model</code> and <code>plssvm.DataSet</code> Python classes are used</li>
</ul>
<p>If the SYCL backend is available additional options can be set.</p>
<ul>
<li><code>PLSSVM_ENABLE_SYCL_HIPSYCL_BACKEND=ON|OFF|AUTO</code> (default: <code>AUTO</code>):<ul>
<li><code>ON</code>: check for hipSYCL as implementation for the SYCL backend and fail if not available</li>
<li><code>AUTO</code>: check for hipSYCL as implementation for the SYCL backend but <b>do not</b> fail if not available</li>
<li><code>OFF</code>: do not check for hipSYCL as implementation for the SYCL backend</li>
</ul>
</li>
<li><code>PLSSVM_ENABLE_SYCL_DPCPP_BACKEND=ON|OFF|AUTO</code> (default: <code>AUTO</code>):<ul>
<li><code>ON</code>: check for DPC++ as implementation for the SYCL backend and fail if not available</li>
<li><code>AUTO</code>: check for DPC++ as implementation for the SYCL backend but <b>do not</b> fail if not available</li>
<li><code>OFF</code>: do not check for DPC++ as implementation for the SYCL backend</li>
</ul>
</li>
</ul>
<p>To use DPC++ for SYCL simply set the <code>CMAKE_CXX_COMPILER</code> to the respective DPC++ clang executable during CMake invocation.</p>
<p>If the SYCL implementation is DPC++ the following additional options are available:</p>
<ul>
<li><code>PLSSVM_SYCL_BACKEND_DPCPP_USE_LEVEL_ZERO</code> (default: <code>OFF</code>): use DPC++'s Level-Zero backend instead of its OpenCL backend</li>
<li><code>PLSSVM_SYCL_BACKEND_DPCPP_GPU_AMD_USE_HIP</code> (default: <code>ON</code>): use DPC++'s HIP backend instead of its OpenCL backend for AMD GPUs</li>
<li><code>PLSSVM_SYCL_BACKEND_DPCPP_ENABLE_AOT</code> (default: <code>ON</code>): enable Ahead-of-Time (AOT) compilation for the specified target platforms</li>
</ul>
<p>If more than one SYCL implementation is available the environment variables <code>PLSSVM_SYCL_HIPSYCL_INCLUDE_DIR</code> and <code>PLSSVM_SYCL_DPCPP_INCLUDE_DIR</code> <b>must</b> be set to the respective SYCL include paths. Note that those paths <b>must not</b> be present in the <code>CPLUS_INCLUDE_PATH</code> environment variable or compilation will fail.</p>
<ul>
<li><code>PLSSVM_SYCL_BACKEND_PREFERRED_IMPLEMENTATION</code> (<code>dpcpp</code>|<code>hipsycl</code>): specify the preferred SYCL implementation if the <code>sycl_implementation_type</code> option is set to <code>automatic</code>; additional the specified SYCL implementation is used in the <code><a class="el" href="namespaceplssvm_1_1sycl.html" title="Namespace containing the C-SVM using the SYCL backend with the preferred SYCL implementation.">plssvm::sycl</a></code> namespace, the other implementations are available in the <code><a class="el" href="namespaceplssvm_1_1dpcpp.html" title="Namespace containing the C-SVM using the SYCL backend with DPC++ as SYCL implementation.">plssvm::dpcpp</a></code> and <code><a class="el" href="namespaceplssvm_1_1hipsycl.html" title="Namespace containing the C-SVM using the SYCL backend with hipSYCL as SYCL implementation.">plssvm::hipsycl</a></code> namespace respectively</li>
</ul>
<h3><a class="anchor" id="autotoc_md6"></a>
Running the tests</h3>
<p>To run the tests after building the library (with <code>PLSSVM_ENABLE_TESTING</code> set to <code>ON</code>) use:</p>
<div class="fragment"><div class="line">ctest</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7"></a>
Generating test coverage results</h3>
<p>To enable the generation of test coverage reports using <code>locv</code> the library must be compiled using the custom <code>Coverage</code> <code>CMAKE_BUILD_TYPE</code>. Additionally, it's advisable to use smaller test files to shorten the <code>ctest</code> step.</p>
<div class="fragment"><div class="line">cmake -DCMAKE_BUILD_TYPE=Coverage -DPLSSVM_TARGET_PLATFORMS=&quot;...&quot; \</div>
<div class="line">      -DPLSSVM_TEST_FILE_NUM_DATA_POINTS=100 \</div>
<div class="line">      -DPLSSVM_TEST_FILE_NUM_FEATURES=50 ..</div>
<div class="line">cmake --build . -- coverage</div>
</div><!-- fragment --><p>The resulting <code>html</code> coverage report is located in the <code>coverage</code> folder in the build directory.</p>
<h3><a class="anchor" id="autotoc_md8"></a>
Creating the documentation</h3>
<p>If doxygen is installed and <code>PLSSVM_ENABLE_DOCUMENTATION</code> is set to <code>ON</code> the documentation can be build using</p>
<div class="fragment"><div class="line">cmake --build . -- doc</div>
</div><!-- fragment --><p>The documentation of the current state of the main branch can be found <a href="https://sc-sgs.github.io/PLSSVM/">here</a>.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
Installing</h2>
<p>The library supports the <code>install</code> target:</p>
<div class="fragment"><div class="line">cmake --build . -- install</div>
</div><!-- fragment --><p>Afterward, the necessary exports should be performed:</p>
<div class="fragment"><div class="line">export CMAKE_PREFIX_PATH=${CMAKE_INSTALL_PREFIX}/share/plssvm/cmake:${CMAKE_PREFIX_PATH}</div>
<div class="line">export MANPATH=${CMAKE_INSTALL_PREFIX}/share/man:$MANPATH</div>
<div class="line"> </div>
<div class="line">export PATH=${CMAKE_INSTALL_PREFIX}/bin:${PATH}</div>
<div class="line">export LD_LIBRARY_PATH=${CMAKE_INSTALL_PREFIX}/lib:${LD_LIBRARY_PATH}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md10"></a>
Usage</h2>
<h3><a class="anchor" id="autotoc_md11"></a>
Generating artificial data</h3>
<p>The repository comes with a Python3 script (in the <code>utility_scripts/</code> directory) to simply generate arbitrarily large data sets.</p>
<p>In order to use all functionality, the following Python3 modules must be installed: <a href="https://docs.python.org/3/library/argparse.html"><code>argparse</code></a>, <a href="https://docs.python.org/3/library/timeit.html"><code>timeit</code></a>, <a href="https://pypi.org/project/numpy/"><code>numpy</code></a>, <a href="https://pypi.org/project/pandas/"><code>pandas</code></a>, <a href="https://scikit-learn.org/stable/"><code>sklearn</code></a>, <a href="https://pypi.org/project/arff/"><code>arff</code></a>, <a href="https://pypi.org/project/matplotlib/"><code>matplotlib</code></a>, <a href="https://pypi.org/project/matplotlib/"><code>mpl_toolkits</code></a>, and <a href="https://pypi.org/project/humanize/"><code>humanize</code></a>.</p>
<div class="fragment"><div class="line">python3 utility_scripts/generate_data.py --help</div>
<div class="line">usage: generate_data.py [-h] --output OUTPUT --format FORMAT [--problem PROBLEM] --samples SAMPLES [--test_samples TEST_SAMPLES] --features FEATURES [--plot]</div>
<div class="line"> </div>
<div class="line">optional arguments:</div>
<div class="line">  -h, --help            show this help message and exit</div>
<div class="line">  --output OUTPUT       the output file to write the samples to (without extension)</div>
<div class="line">  --format FORMAT       the file format; either arff or libsvm</div>
<div class="line">  --problem PROBLEM     the problem to solve; one of: blobs, blobs_merged, planes, planes_merged, ball</div>
<div class="line">  --samples SAMPLES     the number of training samples to generate</div>
<div class="line">  --test_samples TEST_SAMPLES</div>
<div class="line">                        the number of test samples to generate; default: 0</div>
<div class="line">  --features FEATURES   the number of features per data point</div>
<div class="line">  --plot                plot training samples; only possible if 0 &lt; samples &lt;= 2000 and 1 &lt; features &lt;= 3</div>
</div><!-- fragment --><p>An example invocation generating a data set consisting of blobs with 1000 data points with 200 features each could look like:</p>
<div class="fragment"><div class="line">python3 generate_data.py --output data_file --format libsvm --problem blobs --samples 1000 --features 200</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md12"></a>
Training</h3>
<div class="fragment"><div class="line">./plssvm-train --help</div>
<div class="line">LS-SVM with multiple (GPU-)backends</div>
<div class="line">Usage:</div>
<div class="line">  ./plssvm-train [OPTION...] training_set_file [model_file]</div>
<div class="line"> </div>
<div class="line">  -t, --kernel_type arg         set type of kernel function. </div>
<div class="line">                                         0 -- linear: u&#39;*v</div>
<div class="line">                                         1 -- polynomial: (gamma*u&#39;*v + coef0)^degree </div>
<div class="line">                                         2 -- radial basis function: exp(-gamma*|u-v|^2) (default: 0)</div>
<div class="line">  -d, --degree arg              set degree in kernel function (default: 3)</div>
<div class="line">  -g, --gamma arg               set gamma in kernel function (default: 1 / num_features)</div>
<div class="line">  -r, --coef0 arg               set coef0 in kernel function (default: 0)</div>
<div class="line">  -c, --cost arg                set the parameter C (default: 1)</div>
<div class="line">  -e, --epsilon arg             set the tolerance of termination criterion (default: 0.001)</div>
<div class="line">  -i, --max_iter arg            set the maximum number of CG iterations (default: num_features)</div>
<div class="line">  -b, --backend arg             choose the backend: automatic|openmp|cuda|hip|opencl|sycl (default: automatic)</div>
<div class="line">  -p, --target_platform arg     choose the target platform: automatic|cpu|gpu_nvidia|gpu_amd|gpu_intel (default: automatic)</div>
<div class="line">      --sycl_kernel_invocation_type arg</div>
<div class="line">                                choose the kernel invocation type when using SYCL as backend: automatic|nd_range|hierarchical (default: automatic)</div>
<div class="line">      --sycl_implementation_type arg</div>
<div class="line">                                choose the SYCL implementation to be used in the SYCL backend: automatic|dpcpp|hipsycl (default: automatic)</div>
<div class="line">      --performance_tracking arg</div>
<div class="line">                                the output YAML file where the performance tracking results are written to; if not provided, the results are dumped to stderr</div>
<div class="line">      --use_strings_as_labels   use strings as labels instead of plane numbers</div>
<div class="line">      --use_float_as_real_type  use floats as real types instead of doubles</div>
<div class="line">      --verbosity               choose the level of verbosity: full|timing|libsvm|quiet (default: full)</div>
<div class="line">  -q, --quiet                   quiet mode (no outputs regardless the provided verbosity level!)</div>
<div class="line">  -h, --help                    print this helper message</div>
<div class="line">  -v, --version                 print version information</div>
<div class="line">      --input training_set_file</div>
<div class="line">                                </div>
<div class="line">      --model model_file </div>
</div><!-- fragment --><p>The help message only print options available based on the CMake invocation. For example, if CUDA was not available during the build step, it will not show up as possible backend in the description of the <code>--backend</code> option.</p>
<p>The most minimal example invocation is:</p>
<div class="fragment"><div class="line">./plssvm-train /path/to/data_file</div>
</div><!-- fragment --><p>An example invocation using the CUDA backend could look like:</p>
<div class="fragment"><div class="line">./plssvm-train --backend cuda --input /path/to/data_file</div>
</div><!-- fragment --><p>Another example targeting NVIDIA GPUs using the SYCL backend looks like:</p>
<div class="fragment"><div class="line">./plssvm-train --backend sycl --target_platform gpu_nvidia --input /path/to/data_file</div>
</div><!-- fragment --><p>The <code>--backend=automatic</code> option works as follows:</p>
<ul>
<li>if the <code>gpu_nvidia</code> target is available, check for existing backends in order <code>cuda</code> 🠦 <code>hip</code> 🠦 <code>opencl</code> 🠦 <code>sycl</code></li>
<li>otherwise, if the <code>gpu_amd</code> target is available, check for existing backends in order <code>hip</code> 🠦 <code>opencl</code> 🠦 <code>sycl</code></li>
<li>otherwise, if the <code>gpu_intel</code> target is available, check for existing backends in order <code>sycl</code> 🠦 <code>opencl</code></li>
<li>otherwise, if the <code>cpu</code> target is available, check for existing backends in order <code>sycl</code> 🠦 <code>opencl</code> 🠦 <code>openmp</code></li>
</ul>
<p>Note that during CMake configuration it is guaranteed that at least one of the above combinations does exist.</p>
<p>The <code>--target_platform=automatic</code> option works for the different backends as follows:</p>
<ul>
<li><code>OpenMP</code>: always selects a CPU</li>
<li><code>CUDA</code>: always selects an NVIDIA GPU (if no NVIDIA GPU is available, throws an exception)</li>
<li><code>HIP</code>: always selects an AMD GPU (if no AMD GPU is available, throws an exception)</li>
<li><code>OpenCL</code>: tries to find available devices in the following order: NVIDIA GPUs 🠦 AMD GPUs 🠦 Intel GPUs 🠦 CPU</li>
<li><code>SYCL</code>: tries to find available devices in the following order: NVIDIA GPUs 🠦 AMD GPUs 🠦 Intel GPUs 🠦 CPU</li>
</ul>
<p>The <code>--sycl_kernel_invocation_type</code> and <code>--sycl_implementation_type</code> flags are only used if the <code>--backend</code> is <code>sycl</code>, otherwise a warning is emitted on <code>stderr</code>. If the <code>--sycl_kernel_invocation_type</code> is <code>automatic</code>, the <code>nd_range</code> invocation type is always used, except for hipSYCL on CPUs where the hierarchical formulation is used instead (if hipSYCL wasn't build with <code>omp.accelerated</code>). If the <code>--sycl_implementation_type</code> is <code>automatic</code>, the used SYCL implementation is determined by the <code>PLSSVM_SYCL_BACKEND_PREFERRED_IMPLEMENTATION</code> cmake flag.</p>
<h3><a class="anchor" id="autotoc_md13"></a>
Predicting</h3>
<div class="fragment"><div class="line">./plssvm-preidct --help</div>
<div class="line">LS-SVM with multiple (GPU-)backends</div>
<div class="line">Usage:</div>
<div class="line">  ./plssvm-preidct [OPTION...] test_file model_file [output_file]</div>
<div class="line"> </div>
<div class="line">  -b, --backend arg             choose the backend: automatic|openmp|cuda|hip|opencl|sycl (default: automatic)</div>
<div class="line">  -p, --target_platform arg     choose the target platform: automatic|cpu|gpu_nvidia|gpu_amd|gpu_intel (default: automatic)</div>
<div class="line">      --sycl_implementation_type arg</div>
<div class="line">                                choose the SYCL implementation to be used in the SYCL backend: automatic|dpcpp|hipsycl (default: automatic)</div>
<div class="line">      --performance_tracking arg</div>
<div class="line">                                the output YAML file where the performance tracking results are written to; if not provided, the results are dumped to stderr</div>
<div class="line">      --use_strings_as_labels   use strings as labels instead of plane numbers</div>
<div class="line">      --use_float_as_real_type  use floats as real types instead of doubles</div>
<div class="line">      --verbosity               choose the level of verbosity: full|timing|libsvm|quiet (default: full)</div>
<div class="line">  -q, --quiet                   quiet mode (no outputs regardless the provided verbosity level!)</div>
<div class="line">  -h, --help                    print this helper message</div>
<div class="line">  -v, --version                 print version information</div>
<div class="line">      --test test_file          </div>
<div class="line">      --model model_file        </div>
<div class="line">      --output output_file</div>
</div><!-- fragment --><p>An example invocation could look like:</p>
<div class="fragment"><div class="line">./plssvm-preidct --backend cuda --test /path/to/test_file --model /path/to/model_file</div>
</div><!-- fragment --><p>Another example targeting NVIDIA GPUs using the SYCL backend looks like:</p>
<div class="fragment"><div class="line">./plssvm-preidct --backend sycl --target_platform gpu_nvidia --test /path/to/test_file --model /path/to/model_file</div>
</div><!-- fragment --><p>The <code>--target_platform=automatic</code> and <code>--sycl_implementation_type</code> flags work like in the training (<code>./plssvm-train</code>) case.</p>
<h3><a class="anchor" id="autotoc_md14"></a>
Scaling</h3>
<div class="fragment"><div class="line">LS-SVM with multiple (GPU-)backends</div>
<div class="line">Usage:</div>
<div class="line">  ./plssvm-scale [OPTION...] input_file [scaled_file]</div>
<div class="line"> </div>
<div class="line">  -l, --lower arg               lower is the lowest (minimal) value allowed in each dimension (default: -1)</div>
<div class="line">  -u, --upper arg               upper is the highest (maximal) value allowed in each dimension (default: 1)</div>
<div class="line">  -f, --format arg              the file format to output the scaled data set to (default: libsvm)</div>
<div class="line">  -s, --save_filename arg       the file to which the scaling factors should be saved</div>
<div class="line">  -r, --restore_filename arg    the file from which previous scaling factors should be loaded</div>
<div class="line">      --performance_tracking arg</div>
<div class="line">                                the output YAML file where the performance tracking results are written to; if not provided, the results are dumped to stderr</div>
<div class="line">      --use_strings_as_labels   use strings as labels instead of plane numbers</div>
<div class="line">      --use_float_as_real_type  use floats as real types instead of doubles</div>
<div class="line">      --verbosity               choose the level of verbosity: full|timing|libsvm|quiet (default: full)</div>
<div class="line">  -q, --quiet                   quiet mode (no outputs regardless the provided verbosity level!)</div>
<div class="line">  -h, --help                    print this helper message</div>
<div class="line">  -v, --version                 print version information</div>
<div class="line">      --input input_file        </div>
<div class="line">      --scaled scaled_file</div>
</div><!-- fragment --><p>An example invocation could look like:</p>
<div class="fragment"><div class="line">./plssvm-scale -l -0.5 -u 1.5 --input /path/to/input_file --scaled /path/to/scaled_file</div>
</div><!-- fragment --><p>An example invocation to scale a train and test file in the same way looks like:</p>
<div class="fragment"><div class="line">./plssvm-scale -l -1.0 -u 1.0 -s scaling_parameter.txt train_file.libsvm train_file_scaled.libsvm</div>
<div class="line">./plssvm-scale -r scaling_parameter.txt test_file.libsvm test_file_scaled.libsvm</div>
</div><!-- fragment --><p>For more information see the <code>man</code> pages for <code>plssvm-train</code>, <code>plssvm-predict</code>, and <code>plssvm-scale</code> (which are installed via <code>cmake --build . -- install</code>).</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Example code for usage as library</h2>
<p>A simple C++ program (<code>main.cpp</code>) using this library could look like:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="core_8hpp.html">plssvm/core.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;exception&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">      </div>
<div class="line">        <span class="comment">// create a new C-SVM parameter set, explicitly overriding the default kernel function</span></div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structplssvm_1_1detail_1_1parameter.html">plssvm::parameter</a> params{ plssvm::kernel_type = <a class="code" href="namespaceplssvm.html#aa6180d48d5afcdf753fd639d138f180ca89693d3333328e76f4fdeed379e8f9ea">plssvm::kernel_function_type::polynomial</a> };</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// create two data sets: one with the training data scaled to [-1, 1] </span></div>
<div class="line">        <span class="comment">// and one with the test data scaled like the training data</span></div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classplssvm_1_1data__set.html">plssvm::data_set&lt;double&gt;</a> train_data{ <span class="stringliteral">&quot;train_file.libsvm&quot;</span>, { -1.0, 1.0 } };</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classplssvm_1_1data__set.html">plssvm::data_set&lt;double&gt;</a> test_data{ <span class="stringliteral">&quot;test_file.libsvm&quot;</span>, train_data.<a class="code" href="classplssvm_1_1data__set.html#a48c0b487443b61348baba875c191b53d">scaling_factors</a>()-&gt;get() };</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// create C-SVM using the default backend and the previously defined parameter</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> svm = <a class="code" href="namespaceplssvm.html#a3c32d301c324602919245684540e3d67">plssvm::make_csvm</a>(params);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// fit using the training data, (optionally) set the termination criterion</span></div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classplssvm_1_1model.html">plssvm::model</a> model = svm-&gt;fit(train_data, plssvm::epsilon = 10e-6);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// get accuracy of the trained model</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> model_accuracy = svm-&gt;score(model);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;model accuracy: &quot;</span> &lt;&lt; model_accuracy &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// predict the labels</span></div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;int&gt; label = svm-&gt;predict(model, test_data);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// write model file to disk</span></div>
<div class="line">        model.<a class="code" href="classplssvm_1_1model.html#a468e3d4ec17e0ecf8be32b236b57cee0">save</a>(<span class="stringliteral">&quot;model_file.libsvm&quot;</span>);</div>
<div class="line">        </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code" href="classplssvm_1_1exception.html">plssvm::exception</a> &amp;e) {</div>
<div class="line">        std::cerr &lt;&lt; e.<a class="code" href="classplssvm_1_1exception.html#ae801b36bcd872f2557e813b5f20aae58">what_with_loc</a>() &lt;&lt; std::endl;</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line">        std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassplssvm_1_1data__set_html"><div class="ttname"><a href="classplssvm_1_1data__set.html">plssvm::data_set</a></div><div class="ttdoc">Encapsulate all necessary data that is needed for training or predicting using an SVM.</div><div class="ttdef"><b>Definition:</b> data_set.hpp:69</div></div>
<div class="ttc" id="aclassplssvm_1_1data__set_html_a48c0b487443b61348baba875c191b53d"><div class="ttname"><a href="classplssvm_1_1data__set.html#a48c0b487443b61348baba875c191b53d">plssvm::data_set::scaling_factors</a></div><div class="ttdeci">optional_ref&lt; const scaling &gt; scaling_factors() const noexcept</div><div class="ttdoc">Returns the scaling factors as an optional reference used to scale the data points in this data set.</div><div class="ttdef"><b>Definition:</b> data_set.hpp:641</div></div>
<div class="ttc" id="aclassplssvm_1_1exception_html"><div class="ttname"><a href="classplssvm_1_1exception.html">plssvm::exception</a></div><div class="ttdoc">Base class for all custom exception types. Forwards its message to std::runtime_error and saves the e...</div><div class="ttdef"><b>Definition:</b> exceptions.hpp:29</div></div>
<div class="ttc" id="aclassplssvm_1_1exception_html_ae801b36bcd872f2557e813b5f20aae58"><div class="ttname"><a href="classplssvm_1_1exception.html#ae801b36bcd872f2557e813b5f20aae58">plssvm::exception::what_with_loc</a></div><div class="ttdeci">std::string what_with_loc() const</div><div class="ttdoc">Returns a string containing the exception's what() message, the name of the thrown exception class,...</div></div>
<div class="ttc" id="aclassplssvm_1_1model_html"><div class="ttname"><a href="classplssvm_1_1model.html">plssvm::model</a></div><div class="ttdoc">Implements a class encapsulating the result of a call to the SVM fit function. A model is used to pre...</div><div class="ttdef"><b>Definition:</b> model.hpp:50</div></div>
<div class="ttc" id="aclassplssvm_1_1model_html_a468e3d4ec17e0ecf8be32b236b57cee0"><div class="ttname"><a href="classplssvm_1_1model.html#a468e3d4ec17e0ecf8be32b236b57cee0">plssvm::model::save</a></div><div class="ttdeci">void save(const std::string &amp;filename) const</div><div class="ttdoc">Save the model to a LIBSVM model file for later usage.</div><div class="ttdef"><b>Definition:</b> model.hpp:208</div></div>
<div class="ttc" id="acore_8hpp_html"><div class="ttname"><a href="core_8hpp.html">core.hpp</a></div><div class="ttdoc">Core header including all other necessary headers.</div></div>
<div class="ttc" id="anamespaceplssvm_html_a3c32d301c324602919245684540e3d67"><div class="ttname"><a href="namespaceplssvm.html#a3c32d301c324602919245684540e3d67">plssvm::make_csvm</a></div><div class="ttdeci">std::unique_ptr&lt; csvm &gt; make_csvm(const backend_type backend, Args &amp;&amp;...args)</div><div class="ttdoc">Create a new C-SVM using the backend type and additional parameter args.</div><div class="ttdef"><b>Definition:</b> csvm_factory.hpp:158</div></div>
<div class="ttc" id="anamespaceplssvm_html_aa6180d48d5afcdf753fd639d138f180ca89693d3333328e76f4fdeed379e8f9ea"><div class="ttname"><a href="namespaceplssvm.html#aa6180d48d5afcdf753fd639d138f180ca89693d3333328e76f4fdeed379e8f9ea">plssvm::kernel_function_type::polynomial</a></div><div class="ttdeci">@ polynomial</div></div>
<div class="ttc" id="astructplssvm_1_1detail_1_1parameter_html"><div class="ttname"><a href="structplssvm_1_1detail_1_1parameter.html">plssvm::detail::parameter&lt; double &gt;</a></div></div>
</div><!-- fragment --><p>With a corresponding minimal CMake file:</p>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.16)</div>
<div class="line"> </div>
<div class="line">project(LibraryUsageExample</div>
<div class="line">        LANGUAGES CXX)</div>
<div class="line"> </div>
<div class="line">find_package(plssvm CONFIG REQUIRED)</div>
<div class="line"> </div>
<div class="line">add_executable(prog main.cpp)</div>
<div class="line"> </div>
<div class="line">target_compile_features(prog PUBLIC cxx_std_17)</div>
<div class="line">target_link_libraries(prog PUBLIC plssvm::plssvm-all)</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md16"></a>
Using the Python bindings</h3>
<p>Roughly the same can be achieved using our Python bindings with the following Python script:</p>
<div class="fragment"><div class="line">import plssvm</div>
<div class="line"> </div>
<div class="line">try:</div>
<div class="line">    # create a new C-SVM parameter set, explicitly overriding the default kernel function</div>
<div class="line">    params = plssvm.Parameter(kernel_type=plssvm.KernelFunctionType.POLYNOMIAL)</div>
<div class="line">  </div>
<div class="line">    # create two data sets: one with the training data scaled to [-1, 1]</div>
<div class="line">    # and one with the test data scaled like the training data</div>
<div class="line">    train_data = plssvm.DataSet(&quot;train_data.libsvm&quot;, scaling=(-1.0, 1.0))</div>
<div class="line">    test_data = plssvm.DataSet(&quot;test_data.libsvm&quot;, scaling=train_data.scaling_factors())</div>
<div class="line">  </div>
<div class="line">    # create C-SVM using the default backend and the previously defined parameter</div>
<div class="line">    svm = plssvm.CSVM(params)</div>
<div class="line">  </div>
<div class="line">    # fit using the training data, (optionally) set the termination criterion</div>
<div class="line">    model = svm.fit(train_data, epsilon=10e-6)</div>
<div class="line">  </div>
<div class="line">    # get accuracy of the trained model</div>
<div class="line">    model_accuracy = svm.score(model)</div>
<div class="line">    print(&quot;model accuracy: {}&quot;.format(model_accuracy))</div>
<div class="line">  </div>
<div class="line">    # predict labels</div>
<div class="line">    label = svm.predict(model, test_data)</div>
<div class="line">  </div>
<div class="line">    # write model file to disk</div>
<div class="line">    model.save(&quot;model_file.libsvm&quot;)</div>
<div class="line">except plssvm.PLSSVMError as e:</div>
<div class="line">    print(e)</div>
<div class="line">except RuntimeError as e:</div>
<div class="line">    print(e)</div>
</div><!-- fragment --><p><b>Note:</b> it may be necessary to set <code>PYTHONPATH</code> to the <code>lib</code> folder in the PLSSVM install path.</p>
<p>We also provide Python bindings for a <code>plssvm.SVC</code> class that offers the same interface as the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html"><code>sklearn.svm.SVC</code></a> class. Note that currently not all functionality has been implemented in PLSSVM. The respective functions will throw a Python <code>AttributeError</code> if called.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
Citing PLSSVM</h2>
<p>If you use PLSSVM in your research, we kindly request you to cite:</p>
<div class="fragment"><div class="line">@inproceedings{9835379,</div>
<div class="line">  author={Van Craen, Alexander and Breyer, Marcel and Pfl\&quot;{u}ger, Dirk},</div>
<div class="line">  booktitle={2022 IEEE International Parallel and Distributed Processing Symposium Workshops (IPDPSW)}, </div>
<div class="line">  title={PLSSVM: A (multi-)GPGPU-accelerated Least Squares Support Vector Machine}, </div>
<div class="line">  year={2022},</div>
<div class="line">  volume={},</div>
<div class="line">  number={},</div>
<div class="line">  pages={818-827},</div>
<div class="line">  doi={10.1109/IPDPSW55747.2022.00138}</div>
<div class="line">}</div>
</div><!-- fragment --><p> For a full list of all publications involving PLSSVM see our <a href="https://github.com/SC-SGS/PLSSVM/wiki/List-of-Publications-involving-PLSSVM">Wiki Page</a>.</p>
<h2><a class="anchor" id="autotoc_md18"></a>
License</h2>
<p>The PLSSVM library is distributed under the MIT <a href="https://github.com/SC-SGS/PLSSVM/blob/main/LICENSE.md">license</a>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 11 2023 16:08:00 for PLSSVM - Parallel Least Squares Support Vector Machine by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
